<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        * {
            box-sizing: border-box;
        }

        canvas {
            margin-top: 100px;
            border: 1px solid black;
            display: block;
            margin: 0 auto;

            image-rendering: crisp-edges;
            /* image-rendering: pixelated; */
        }
    </style>
</head>

<body>

    <div>
        PhysicsEngine2D Collision.
        <canvas id="root" width="920" height="900"></canvas>
    </div>


    <!-- <script src="./GameManager.js"></script> -->

    <script type="module">
        // alert();
        var KEYS = {};
        window.addEventListener('keydown', e => {
            KEYS[e.key] = true;
        })
        window.addEventListener('keyup', e => {
            KEYS[e.key] = false;
        })

        const width = 920, height = 900;
        ctx = document.getElementById('root').getContext('2d');

        import { Engine2D, Circle, Vector, Line, Forces, RayCast } from './PhysicsEngine2DLib/main.js';
        import GameManager from './GameManager.js';
        import Cell from './Cell.js';

        let game = new GameManager();
        game.setCanvasSize(width, height);
        game.setCtx(ctx);


        let circle = new Circle(200, 240, 28);
        circle.setMass(1000);
        circle.elasticity = 0.7;

        game.addObject(circle)


        let line = new Line(0, 0, 0, height, 0.3, 'red');
        game.addObject(line);
        let line2 = new Line(0, 0, width, 0, 0.3, 'red');
        game.addObject(line2);
        let line3 = new Line(width, 0, width, height, 0.3, 'red');
        game.addObject(line3);
        let line4 = new Line(0, height, width, height, 0.3, 'red');
        game.addObject(line4);

        let lines = [
            // [0, height - 115, width, height - 115],
            [160, height - 100, width - 250, height - 100],
            //
            [160, 600, 400, 600],
            [700, 160, 280, 190],
            [0, 150, 600, 150, 0.97],
            [width, 600, 500, 700],
            [160, 300, 160, height - 100]
        ]
        for (let line of lines) {
            game.addObject(new Line(line[0], line[1], line[2], line[3], line[4], line[5]));
        }



        let cell = new Cell(540, 340, 20);
        game.addObject(cell);
        game.keyControl(cell)

        setTimeout(() => {
            game.init();
            // console.log(game.objects);
        }, 500)


    </script>
</body>

</html>